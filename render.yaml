services:
  - type: web
    name: sharemeal-api
    runtime: node
    region: oregon  # Change to your preferred region
    buildCommand: cd backend && npm install
    startCommand: cd backend && npm start
    preDeployCommand: cd backend && npm run migrate
    
    # Auto-pull and redeploy on main branch push
    autoDeploy: true
    branch: main
    
    # Expose port
    port: 3000
    
    # Health check
    healthCheckPath: /
    
    # Environment variables (set in Render dashboard)
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      # Add others in dashboard for security:
      # DB_HOST, DB_PORT, DB_USER, DB_PASSWORD, DB_NAME, JWT_SECRET, ADMIN_SECRET, SERVICE_TOKEN, CORS_ORIGIN
    
    # App instance size
    plan: standard  # Change to standard for better performance
    numInstances: 1
    
    # Environment region (for low latency from database)
    region: oregon
